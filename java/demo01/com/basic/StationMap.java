package com.basic.cope;

import java.util.*;

public class StationMap {
    /*
    * 每两个换乘点之间为一个路段
    * 这是一个工具类
    * */

    // 装载站点
    public static ArrayList<ArrayList<String>> getSta() {
        writeMap();
        return sta;
    }

    private static ArrayList<ArrayList<String>> sta = new ArrayList<>();

    public static void writeMap() {
        ArrayList<String> a = new ArrayList<>();
        sta.add(a);
        ArrayList<String> b = new ArrayList<>();
        sta.add(b);
        ArrayList<String> c = new ArrayList<>();
        sta.add(c);
        ArrayList<String> d = new ArrayList<>();
        sta.add(d);
        ArrayList<String> e = new ArrayList<>();
        sta.add(e);
        ArrayList<String> f = new ArrayList<>();
        sta.add(f);
        ArrayList<String> g = new ArrayList<>();
        sta.add(g);
        ArrayList<String> h = new ArrayList<>();
        sta.add(h);
        ArrayList<String> i = new ArrayList<>();
        sta.add(i);
        ArrayList<String> j = new ArrayList<>();
        sta.add(j);
        ArrayList<String> k = new ArrayList<>();
        sta.add(k);
        ArrayList<String> l = new ArrayList<>();
        sta.add(l);
        ArrayList<String> m = new ArrayList<>();
        sta.add(m);
        ArrayList<String> n = new ArrayList<>();
        sta.add(n);
        ArrayList<String> o = new ArrayList<>();
        sta.add(o);
        ArrayList<String> p = new ArrayList<>();
        sta.add(p);
        ArrayList<String> q = new ArrayList<>();
        sta.add(q);
        ArrayList<String> r = new ArrayList<>();
        sta.add(r);
        ArrayList<String> s = new ArrayList<>();
        sta.add(s);
        ArrayList<String> t = new ArrayList<>();
        sta.add(t);
        ArrayList<String> u = new ArrayList<>();
        sta.add(u);
        ArrayList<String> v = new ArrayList<>();
        sta.add(v);
        ArrayList<String> w = new ArrayList<>();
        sta.add(w);
        ArrayList<String> x = new ArrayList<>();
        sta.add(x);
        ArrayList<String> y = new ArrayList<>();
        sta.add(y);
        ArrayList<String> z = new ArrayList<>();
        sta.add(z);
        ArrayList<String> a1 = new ArrayList<>();
        sta.add(a1);
        ArrayList<String> a2 = new ArrayList<>();
        sta.add(a2);
        ArrayList<String> a3 = new ArrayList<>();
        sta.add(a3);
        ArrayList<String> a4 = new ArrayList<>();
        sta.add(a4);
        ArrayList<String> a5 = new ArrayList<>();
        sta.add(a5);
        ArrayList<String> a6 = new ArrayList<>();
        sta.add(a6);
        ArrayList<String> a7 = new ArrayList<>();
        sta.add(a7);
        ArrayList<String> a8 = new ArrayList<>();
        sta.add(a8);
        ArrayList<String> a9 = new ArrayList<>();
        sta.add(a9);
        ArrayList<String> a10 = new ArrayList<>();
        sta.add(a10);
        ArrayList<String> a11 = new ArrayList<>();
        sta.add(a11);
        ArrayList<String> a12 = new ArrayList<>();
        sta.add(a12);
        ArrayList<String> a13 = new ArrayList<>();
        sta.add(a13);
        a.add("Sta24");
        a.add("Sta51");
        a.add("Sta105");
        a.add("Sta139");
        a.add("Sta71");
        a.add("Sta57");
        a.add("Sta76");
        a.add("Sta52");
        a.add("Sta68");
        a.add("Sta151");
        a.add("Sta48");
        a.add("Sta27");
        a.add("Sta81");
        a.add("Sta127");
        b.add("Sta73");
        b.add("Sta148");
        b.add("Sta60");
        b.add("Sta127");
        c.add("Sta127");
        c.add("Sta123");
        c.add("Sta47");
        d.add("Sta1");
        d.add("Sta159");
        d.add("Sta47");
        e.add("Sta47");
        e.add("Sta108");
        e.add("Sta83");
        e.add("Sta107");
        e.add("Sta154");
        e.add("Sta150");
        e.add("Sta64");
        e.add("Sta89");
        f.add("Sta127");
        f.add("Sta91");
        f.add("Sta41");
        g.add("Sta89");
        g.add("Sta80");
        g.add("Sta97");
        g.add("Sta110");
        g.add("Sta106");
        g.add("Sta34");
        g.add("Sta128");
        g.add("Sta74");
        g.add("Sta149");
        g.add("Sta49");
        g.add("Sta65");
        h.add("Sta136");
        h.add("Sta89");
        i.add("Sta89");
        i.add("Sta137");
        i.add("Sta101");
        i.add("Sta31");
        i.add("Sta17");
        i.add("Sta23");
        j.add("Sta23");
        j.add("Sta20");
        j.add("Sta55");
        j.add("Sta70");
        j.add("Sta13");
        j.add("Sta140");
        k.add("Sta140");
        k.add("Sta99");
        k.add("Sta166");
        k.add("Sta124");
        k.add("Sta28");
        k.add("Sta36");
        k.add("Sta122");
        k.add("Sta77");
        l.add("Sta140");
        l.add("Sta111");
        l.add("Sta82");
        l.add("Sta164");
        l.add("Sta152");
        l.add("Sta75");
        m.add("Sta75");
        m.add("Sta102");
        n.add("Sta75");
        n.add("Sta45");
        o.add("Sta75");
        o.add("Sta8");
        o.add("Sta6");
        o.add("Sta7");
        o.add("Sta160");
        o.add("Sta94");
        o.add("Sta87");
        p.add("Sta11");
        p.add("Sta121");
        p.add("Sta125");
        p.add("Sta153");
        p.add("Sta112");
        p.add("Sta33");
        p.add("Sta109");
        p.add("Sta87");
        q.add("Sta58");
        q.add("Sta38");
        q.add("Sta165");
        q.add("Sta62");
        q.add("Sta19");
        q.add("Sta59");
        q.add("Sta84");
        q.add("Sta90");
        r.add("Sta23");
        r.add("Sta26");
        r.add("Sta90");
        s.add("Sta43");
        s.add("Sta10");
        s.add("Sta96");
        s.add("Sta132");
        s.add("Sta37");
        s.add("Sta16");
        s.add("Sta69");
        s.add("Sta54");
        s.add("Sta56");
        t.add("Sta90");
        t.add("Sta134");
        u.add("Sta87");
        u.add("Sta88");
        u.add("Sta145");
        u.add("Sta103");
        u.add("Sta4");
        u.add("Sta2");
        u.add("Sta85");
        u.add("Sta134");
        v.add("Sta87");
        v.add("Sta35");
        v.add("Sta42");
        v.add("Sta147");
        v.add("Sta117");
        v.add("Sta44");
        v.add("Sta158");
        v.add("Sta142");
        v.add("Sta141");
        v.add("Sta113");
        v.add("Sta167");
        v.add("Sta135");
        w.add("Sta56");
        w.add("Sta118");
        w.add("Sta115");
        x.add("Sta115");
        x.add("Sta126");
        x.add("Sta29");
        x.add("Sta144");
        x.add("Sta67");
        x.add("Sta30");
        x.add("Sta41");
        y.add("Sta143");
        y.add("Sta156");
        y.add("Sta61");
        y.add("Sta50");
        y.add("Sta119");
        y.add("Sta66");
        y.add("Sta12");
        y.add("Sta161");
        y.add("Sta21");
        y.add("Sta133");
        y.add("Sta22");
        y.add("Sta138");
        y.add("Sta41");
        z.add("Sta120");
        z.add("Sta130");
        z.add("Sta146");
        z.add("Sta25");
        z.add("Sta63");
        a1.add("Sta47");
        a1.add("Sta18");
        a1.add("Sta79");
        a1.add("Sta53");
        a1.add("Sta163");
        a1.add("Sta9");
        a1.add("Sta129");
        a1.add("Sta63");
        a2.add("Sta41");
        a2.add("Sta32");
        a2.add("Sta116");
        a2.add("Sta92");
        a2.add("Sta3");
        a3.add("Sta3");
        a3.add("Sta93");
        a3.add("Sta72");
        a3.add("Sta15");
        a4.add("Sta3");
        a4.add("Sta46");
        a4.add("Sta86");
        a4.add("Sta15");
        a5.add("Sta157");
        a5.add("Sta114");
        a6.add("Sta115");
        a6.add("Sta162");
        a6.add("Sta114");
        a7.add("Sta115");
        a7.add("Sta40");
        a7.add("Sta131");
        a7.add("Sta39");
        a7.add("Sta100");
        a7.add("Sta135");
        a8.add("Sta114");
        a8.add("Sta168");
        a8.add("Sta135");
        a9.add("Sta135");
        a9.add("Sta134");
        a10.add("Sta15");
        a10.add("Sta95");
        a10.add("Sta134");
        a11.add("Sta56");
        a11.add("Sta23");
        a12.add("Sta63");
        a12.add("Sta3");
        a13.add("Sta15");
        a13.add("Sta114");
    }
    // 得到一个站点附近的换乘点
    public static HashSet<String> getSwap(String station) {
        HashSet<String> strings = new HashSet<>();
        ArrayList<Integer> num = new ArrayList<>();
        for (int i = 0; i < sta.size(); i++) {
            if (sta.get(i).contains(station)) {
                num.add(i);
            }
        }
        for (Integer integer : num) {
            if (noOne(sta.get(integer).get(0))) {
                strings.add(sta.get(integer).get(0));
            }
            if (noOne(sta.get(integer).get(sta.get(integer).size() - 1))) {
                strings.add(sta.get(integer).get(sta.get(integer).size() - 1));
            }
        }
        strings.remove(station);
        return strings;
    }
    // 判断是不是换乘点  如果该点不存在返回 null
    public static Boolean noOne(String station) {
        int i = 0;
        for (ArrayList<String> strings : sta) {
            if (strings.contains(station)) {
                i++;
            }
        }
        if (i > 1) {
            return true;
        } else if (i==1){
            return false;
        }else {
            return null;
        }
    }

    // 判断两个站点在不在一条路段上
    public static boolean isSameRouse(String st, String end) {
        ArrayList<Integer> op = new ArrayList<>();
        ArrayList<Integer> ed = new ArrayList<>();
        for (int i = 0; i < sta.size(); i++) {
            if (sta.get(i).contains(st)) {
                op.add(i);
            }
            if (sta.get(i).contains(end)) {
                ed.add(i);
            }
        }
        for (Integer integer : op) {
            for (Integer integer1 : ed) {
                if (integer.equals(integer1)) {

                    return true;
                }
            }
        }
        return false;
    }
    // 得到这两个站点所在路段的序号（ArrayList<ArrayList<String>> sta 中的序号）
    public static Integer getSameRouse(String st, String end) {
        ArrayList<Integer> op = new ArrayList<>();
        ArrayList<Integer> ed = new ArrayList<>();
        for (int i = 0; i < sta.size(); i++) {
            if (sta.get(i).contains(st)) {
                op.add(i);
            }
            if (sta.get(i).contains(end)) {
                ed.add(i);
            }
        }
        for (Integer integer : op) {
            for (Integer integer1 : ed) {
                if (integer.equals(integer1)) {

                    return integer;
                }
            }
        }
        return null;
    }
    // 将一站点一换乘点处理为两个换乘点
    public static String[] realNoOne(String key, String value) {
        String[] map = {key, value};
        if (!noOne(key)) {
            for (ArrayList<String> strings : sta) {
                if (strings.contains(key)) {
                    int index = strings.indexOf(value);
                    map[0] = index > 0 ? strings.get(0) : strings.get(strings.size() - 1);
                    return map;
                }
            }
        }
        return map;
    }
    // 找出最短路径并输出
    public static ArrayList<LinkedHashSet<String>> getMinSizeSet(ArrayList<Rouse> all) {
        ArrayList<LinkedHashSet<String>> li = new ArrayList<>();
        ArrayList<LinkedHashSet<String>> lil = new ArrayList<>();
        ArrayList<Integer> subs = new ArrayList<>();
        int min = 1000,sub=0;
        for (Rouse rouse : all) {
            LinkedHashSet<String> set = new LinkedHashSet<>();
            for (String[] strings : rouse.getRouse()) {
                List<String> list = sta.get(getSameRouse(strings[0], strings[1]));
                int op = list.indexOf(strings[0]);
                int ed = list.indexOf(strings[1]);
                if (!noOne(strings[0]) || !noOne(strings[1])){
                     list =  list.subList(Math.min(op, ed), Math.max(op, ed)+1);
                     op = list.indexOf(strings[0]);
                     ed = list.indexOf(strings[1]);
                }
                if (op<ed){
                    for (int i = 0; i <= ed - op; i++) {
                        set.add(list.get(i));
                    }
                }else {
                    for (int i = op - ed; i >= 0; i--) {
                        set.add(list.get(i));
                    }
                }
            }
            li.add(set);
        }
        for (int i = 0; i < li.size(); i++) {
            if (li.get(i).size()<min) {
                min = li.get(i).size();
                sub = i;
            }
        }
        for (int i = 0; i < li.size(); i++) {
            if (li.get(i).size()<=min+10){ // <- min+10  其中min表示最短路径的站数，10表示得到较近路径相对最短路径的最大长度
                subs.add(i);
            }
        }
        for (Integer integer : subs) {
            lil.add(li.get(integer));
        }

        return lil;
    }

}
